version: '3'
services:
  mongo:
    image: mvertes/alpine-mongo:latest
    expose:
      - "27017"
      - "37017"
    environment:
      - MONGO_DATA_DIR=/data/db
      - MONGO_LOG_DIR=/dev/null
      # - MONGODB_USER="user"
      # - MONGODB_PASS="pass"
    volumes:
      - ./volumes/mongodb/data:/data/db:rw
    restart: always
    ports:
      - 27017:27017
    networks:
        sandbox:
  cinema-server:
    build:
      context: ./cinema-service/
      dockerfile: Dockerfile
    image: app:cinema-server
    volumes:
      - ./cinema-service/:/usr/src/app/:rw
    environment:
      NODE_ENV: development
      WAIT_HOSTS: mongo:27017
    ports:
      - "3030:3030"
      - "56746:56746"
    networks:
      sandbox:
    depends_on:
      - mongo

  movie-server:
    build:
      context: ./movie-service/
      dockerfile: Dockerfile
    image: app:movie-server
    volumes:
      - ./movie-service/:/usr/src/app/:rw
    environment:
      NODE_ENV: development
      WAIT_HOSTS: mongo:27017
    ports:
      - "3040:3040"
      - "56747:56747"
    networks:
      sandbox:
    depends_on:
      - mongo

  users-server:
    build:
      context: ./users-service/
      dockerfile: Dockerfile
    image: app:users-server
    volumes:
      - ./users-service/:/usr/src/app/:rw
    environment:
      NODE_ENV: development
      WAIT_HOSTS: mongo:27017
    ports:
      - "3050:3050"
      - "56748:56748"
    networks:
      sandbox:
    depends_on:
      - mongo      
      
networks: 
  sandbox:   
    
